.Start Start
tape3: .allocate #8
tape: .String “20001112”
text2: .String “1011102021111010110100111”
w: .Integer #0
x: .Integer #0
y: .Integer #0
z: .Integer #0

Start:  movar tape r0
movmr tape r1
movar tape3 r2
addir #1 r0
jsr splitStringIntoParts
jsr Loop
jsr Print

splitStringIntoParts: movxr r0 r3
movrm r3 r2
addir #1 r2
addir #1 r0
sojnz r1 splitStringIntoParts
ret

Loop:  movir #5 r8
mulmr y r8
addir #1 r8
addmr text2 r8
movxr r8 r7
cmpmr z r7
jmpz Loop2
movmr y r6
addir #1 r6
movrm r6 y
movmr x r5
cmpir #8 r5
jmpz WIsOne
movmr y r5
cmpir #5 r5
jmpz WIsOne
movir #0 r9
cmpmr w r9
jmpz Loop
ret

Loop2: movmr x r3
addir #1 r3
movar tape3 r2
addrr r2 r3
movxr r3 r2
movir #5 r8
mulmr y r8
addir #2 r8
addmr text2 r8
movxr r8 r7
cmprr r7 r2
jmpz Loop3
ret

Loop3: movir #5 r8
mulmr y r8
addir #3 r8
addmr text2 r8
movxr r8 r7
movrm r7 z
movar tape3 r5
addir #1 r5
addmr x r5
movir #5 r8
mulmr y r8
addir #4 r8
addmr text2 r8
movxr r8 r7
addrx r7 r5
movir #5 r8
mulmr y r8
addir #5 r8
addmr text2 r8
movxr r8 r7
cmpir #1 r7
jmpz Loop4
jmpnz Loop5
movir #-1 r6
movrm r6 y

Loop4: movar x r5
movmr x r4
addir 1 r4
movrx r4 r5
ret

Loop5: movar x r5
movmr x r4
subir 1 r4
movrx r4 r5
ret

WIsOne: movir #1 r4
movrm r4 w
ret

Print:  movmr tape r0
movmr tape r1
outcx r1
addir #1 r1
sojnz r0 Print
halt

